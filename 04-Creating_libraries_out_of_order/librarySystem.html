<script src="../simpletest.js"></script>
<script>

// Prototype implementation


// Function signature


// Function parameters


// Callback parameters


// Return value

  
// Function description
  

// Requirements

// Function implementation
(function(root, undefined) {
  'use strict';
  const libraryStorage = {};
  
  function librarySystem(libraryName, dependencies, callback) {
    if (arguments.length > 1) {
      let availableDependencies = [];
      let missingDependencies = [];

      if (!Array.isArray(dependencies)) {
        throw new TypeError(`${dependencies} is not an array.`);
      }
   
      function checkDependencies() {
        if (dependencies.length > 0) {
          availableDependencies.length = 0;
          missingDependencies.length = 0;
          dependencies.forEach(function(dependency) {
            if (dependency in libraryStorage && typeof libraryStorage[dependency] !== 'function') {
              availableDependencies.push(libraryStorage[dependency]);
            }
            else {
              missingDependencies.push(dependency);
            }
          });
        }

        if (dependencies.length === availableDependencies.length) {
          libraryStorage[libraryName] = callback(...availableDependencies);
        }
        else {
          console.log(`%cLibrary is loaded, but currently lacks ${missingDependencies.length} dependencies: ${missingDependencies}.`, 'color: red');
          libraryStorage[libraryName] = checkDependencies;
        }
      }

      checkDependencies();
    } 
    else {
      if (typeof libraryStorage[libraryName] === 'function') {
        libraryStorage[libraryName]();
      }

      if (libraryName in libraryStorage && typeof libraryStorage[libraryName] !== 'function') {
        return libraryStorage[libraryName];
      }
      else if (!(libraryName in libraryStorage)){
        throw new ReferenceError(`${libraryName} is not defined.`);
      }
    }
  }

  root['librarySystem'] = librarySystem;

})(this);

tests({
  '': function() {}
});

</script>